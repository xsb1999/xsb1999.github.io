<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Andy Xu&#39;s Blog</title>
  
  
  <link href="http://blog.andy.fit/atom.xml" rel="self"/>
  
  <link href="http://blog.andy.fit/"/>
  <updated>2021-11-19T05:13:38.095Z</updated>
  <id>http://blog.andy.fit/</id>
  
  <author>
    <name>Andy Xu</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>「Vortex」Deep Learning Based Reconnection Detection During the Evolution of Quantum Vortices in Bose-Einstein Condensate</title>
    <link href="http://blog.andy.fit/2021/08/28/Vortex/"/>
    <id>http://blog.andy.fit/2021/08/28/Vortex/</id>
    <published>2021-08-28T06:26:57.000Z</published>
    <updated>2021-11-19T05:13:38.095Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/Vortex/2.gif" alt="2" style="zoom:78%;" /><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>The reconnection phenomenon of quantum vortex is one of the important research fields of topological fluid mechanics. Although reconnection is the main form of changing the vortex topology, the research on reconnection is a relatively new field. There is no method that is highly reliable and does not require a large amount of manual calibration to detect the position of reconnection in the vortex. For these reasons, we propose a new method that uses deep learning combined with the Gross-Pitaevskii equation (GPE) to detect the exact time and location of the reconnection.</p><p>Quantum vortices are similar to bubbles in water. They can move, change shape, meet other vortices, combine, reconnect, and then separate into two new vortices. The purpose of this project is to find the precise time and location of all vortices which are reconnected.</p><p>As shown in the figure below, there are two vortices in one space, and they intersect (reconnect) at three places. Our task is to identify the specific space-time coordinates of all these points.</p><img src="/images/Vortex/1.png" alt="1" style="zoom:56%;" /><span id="more"></span><h2 id="Research-Overview"><a href="#Research-Overview" class="headerlink" title="Research Overview"></a>Research Overview</h2><p><img src="/images/Vortex/0.png" alt="0"></p><h4 id="S1-amp-S2-Reconnection-localization"><a href="#S1-amp-S2-Reconnection-localization" class="headerlink" title="S1 &amp; S2. Reconnection localization"></a>S1 &amp; S2. Reconnection localization</h4><p>For each data input, First, we’ll localize an area with all vortices, then try to use GNN to search for all reconnection areas at that moment.</p><img src="/images/Vortex/6.png" alt="0" style="zoom:50%;" /><h4 id="S3-Area-Tracing-by-Markov-chain-amp-Survival-Analysis"><a href="#S3-Area-Tracing-by-Markov-chain-amp-Survival-Analysis" class="headerlink" title="S3. Area Tracing by Markov chain &amp; Survival Analysis"></a>S3. Area Tracing by Markov chain &amp; Survival Analysis</h4><p>After that, we will put all data of one configuration together. To connect search results with reconnections events, use Hidden Markov Chains to trace their path.</p><img src="/images/Vortex/7.png" alt="0" style="zoom:50%;" /><h4 id="S4-Reconnection-Detection-by-CNN-amp-CG"><a href="#S4-Reconnection-Detection-by-CNN-amp-CG" class="headerlink" title="S4. Reconnection Detection by CNN &amp; CG"></a>S4. Reconnection Detection by CNN &amp; CG</h4><p>At last step, we have 2 plans. Plan A is to replicate the manul recognition with an Evaluation Function. Plan B will transfer 4-dimensional problem into a 2-dimensional problem and modify the existing CNN approach to detect reconnection.</p><img src="/images/Vortex/8.png" alt="0" style="zoom:50%;" /><img src="/images/Vortex/9.png" alt="0" style="zoom:50%;" /><h2 id="Research-Detail"><a href="#Research-Detail" class="headerlink" title="Research Detail"></a>Research Detail</h2><h4 id="S1-amp-S2-Reconnection-localization-1"><a href="#S1-amp-S2-Reconnection-localization-1" class="headerlink" title="S1 &amp; S2. Reconnection localization"></a>S1 &amp; S2. Reconnection localization</h4><p>We need to mark the approximate location of the Areas’ center manually. To save the time we’ll spend on labeling, we propose to introduce semi-supervised learning. </p><p>Tentatively, we will try GANs +GNN. Our current idea is to adopt a point cloud containing three-dimensional coordinate values and k attributes to construct a graph structure containing labelled and unlabeled nodes.</p><img src="/images/Vortex/10.png" alt="0" style="zoom:60%;" /><p>As we believe that GANs is a promising method to improve our model’s performance, we only map part of the labeled nodes to the feature space to learn representation and we’ll use graph embedding to learn the latent distributed representation and then combine it with the original feature vector. This combination will be our input. The generator generates pseudo inputs while the discriminator aims to classify unlabeled data and distinguish between generated and real data.</p><img src="/images/Vortex/11.png" alt="0" style="zoom:100%;" /><p>**Flow chart of GANs: ** </p><img src="/images/Vortex/12.png" alt="0" style="zoom:60%;" /><p>Under this framework, we also noticed several details: </p><p>First, inspired by a paper, we may divide the generator into two parts: the first part generates attributes of fake nodes, and the second generates links from fake nodes to existing nodes.</p><img src="/images/Vortex/13.png" alt="0" style="zoom:80%;" /><p>Moreover, based on the current framework, we will learn more about CycleGans to transform input samples and restrict the generated structure from deviating too far. By adding these restrictions, we can also reflect transitivity and propose a means of regularizing structured data.</p><img src="/images/Vortex/14.png" alt="0" style="zoom:75%;" /><h4 id="S3-Area-Tracing-by-Markov-chain-amp-Survival-Analysis-1"><a href="#S3-Area-Tracing-by-Markov-chain-amp-Survival-Analysis-1" class="headerlink" title="S3. Area Tracing by Markov chain &amp; Survival Analysis"></a>S3. Area Tracing by Markov chain &amp; Survival Analysis</h4><p>As shown in the picture, multiple reconnections are taking place at the same time. Each of these reconnections are constantly moving and deforming, respectively. To classify reconnection areas by reconnection events for further analysis, we must correlate the reconnections from various time steps into several paths. However, there is currently no reconnection tracing technology.</p><p><img src="/images/Vortex/15.png" alt="15"></p><p>Fortunately, the “Biot-Savart law” model can approximately predict the motion of the vortex curve. Then, implement error analysis on the “Biot-Savart”, one can give the possibility distribution of the path, which allows us to apply Hidden Markov Chains.</p><img src="/images/Vortex/16.png" alt="15" style="zoom:30%;" /><br/><h4 id="S4-Reconnection-Detection-by-CNN-amp-CG-1"><a href="#S4-Reconnection-Detection-by-CNN-amp-CG-1" class="headerlink" title="S4. Reconnection Detection by CNN &amp; CG"></a>S4. Reconnection Detection by CNN &amp; CG</h4><p>After the reconnection area tracing, we can get the evolution links of all reconnection events for further time series analysis. Basing on that, we’ll move on to get the accurate spatiotemporal coordinates of the reconnection.</p><p>This picture shows an example: one can learn that the reconnection happens at a specific moment between “t” equals 20 to 24. To find that moment, we’ll carry out our final part, the reconnection detection.</p><img src="/images/Vortex/17.png" alt="15" style="zoom:60%;" /><p>As the critical part of this project, we have prepared 2 Plans for this step. Plan A is based on computer graphics (CG), and PLAN B is based on CNN.</p><h5 id="Reconnection-Detection-by-CG"><a href="#Reconnection-Detection-by-CG" class="headerlink" title="Reconnection Detection by CG"></a>Reconnection Detection by CG</h5><img src="/images/Vortex/18.png" alt="15" style="zoom:55%;" /><p>As shown in the picture, there are 5 states for a reconnection event. At the reconnection moment, the 4 branches will overlap and form an “X” shape. Therefore, by observing the overlap of them, one can determine whether the reconnection is happening.</p><p>Basing on that, by introducing CG methods like DDA and Bresenham algorithm, we may draw two pairs of extension lines of the two parts of incoming vortices centerline, directing on the reconnection area. We are also planning to try the Genetic algorithm on it to determine those parameters more accurately.</p><img src="/images/Vortex/19.png" alt="15" style="zoom:45%;" /><p>Briefly speaking, compared with DDA, Bresenham is faster because it only uses very cheap operations like integer addition, subtraction and bit shifting.</p><img src="/images/Vortex/20.png" alt="15" style="zoom:45%;" /><img src="/images/Vortex/21.png" alt="15" style="zoom:45%;" /><p>According to the equations of these four straight lines, we intend to set a function to evaluate the overlap of two pairs of half-lines in each moment, for example, the function can be the product of the distance between two pairs of lines, which is shown in the picture as ∆r1∙∆r2.</p><p>Before the reconnection, the two parts of the vortices will approach, reunite and reconnect to each other with the function’value monotonically decreasing; after that, two new vortex parts will be created and move towards different directions, where the function’value monotonically increases.</p><p>Therefore, one can assume that reconnection occurs during the period when the evaluation function tends to fall into a sufficiently small value, such as the C-E interval in this figure.</p><img src="/images/Vortex/22.png" alt="15" style="zoom:45%;" /><p>For example, when T equals 20, the two pairs of lines are not fully overlapped. By t equals 22, they are apparent overlapping, Finally, when T equals 24, the overlapping degree decrease. In this case, the reconnection may occur around Time 22.</p><img src="/images/Vortex/23.png" alt="15" style="zoom:55%;" /><p>Plan A has two advantages. Firstly, it does not require the cost of supervised learning, like, a large amount of data annotation or computing power; Secondly, it is logically transparent while ANN is opaque, contributing to physical and fluid mechanics explanations.</p><p>However, Plan A also has limitations. It requires high accuracy and tests on different kinds of evaluation functions.</p><h5 id="Reconnection-Detection-by-CNN"><a href="#Reconnection-Detection-by-CNN" class="headerlink" title="Reconnection Detection by CNN"></a>Reconnection Detection by CNN</h5><p>On the other hand, Plan B is a method combining existing deep learning technology. The main idea, is to transform the recognition task from the 3D evolutionary process into a 2D still image. This method does not rely on high precision in CG method.</p><img src="/images/Vortex/24.png" alt="15" style="zoom:45%;" /><p>Firstly, as indicated by the grey dots, the saddle points of the 3D density field will help draw two orthogonal cross-sections, which will be the input to a CNN network. The network can detect the number of vortices in the cross-sections.</p><img src="/images/Vortex/25.png" alt="15" style="zoom:45%;" /><p>For example, if the reconnection occurs between T=20 and T=24, the CNN will detect a vortex number change in both sections between two moments, leading to the reconnection’s spatiotemporal coordinates.</p><img src="/images/Vortex/26.png" alt="15" style="zoom:45%;" /><p>Plan B also has disadvantages. The training of this CNN requires a large amount of manually labelled data and a lot of time. To solve this problem, we may consider applying the transfer learning method. Using a pre-trained model combined with a small amount of our labelled data for fine-tuning, one can train the model with less effort. We believe that such training will guarantee the accuracy of the vortex count detection model.</p><p>The CNN and the data mentioned in our pre-training model comes from a paper published this year by a Japanese research group.</p><br><p>After the 4-step above, we still have many aspects of research to dig into, and we are looking forward to exploring further in the future.</p><br>]]></content>
    
    
    <summary type="html">&lt;img src=&quot;/images/Vortex/2.gif&quot; alt=&quot;2&quot; style=&quot;zoom:78%;&quot; /&gt;

&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;The reconnection phenomenon of quantum vortex is one of the important research fields of topological fluid mechanics. Although reconnection is the main form of changing the vortex topology, the research on reconnection is a relatively new field. There is no method that is highly reliable and does not require a large amount of manual calibration to detect the position of reconnection in the vortex. For these reasons, we propose a new method that uses deep learning combined with the Gross-Pitaevskii equation (GPE) to detect the exact time and location of the reconnection.&lt;/p&gt;
&lt;p&gt;Quantum vortices are similar to bubbles in water. They can move, change shape, meet other vortices, combine, reconnect, and then separate into two new vortices. The purpose of this project is to find the precise time and location of all vortices which are reconnected.&lt;/p&gt;
&lt;p&gt;As shown in the figure below, there are two vortices in one space, and they intersect (reconnect) at three places. Our task is to identify the specific space-time coordinates of all these points.&lt;/p&gt;
&lt;img src=&quot;/images/Vortex/1.png&quot; alt=&quot;1&quot; style=&quot;zoom:56%;&quot; /&gt;</summary>
    
    
    
    
    <category term="Machine Learning" scheme="http://blog.andy.fit/tags/Machine-Learning/"/>
    
    <category term="Deep Learning" scheme="http://blog.andy.fit/tags/Deep-Learning/"/>
    
    <category term="Computer Graphics" scheme="http://blog.andy.fit/tags/Computer-Graphics/"/>
    
    <category term="Quantum Vortex" scheme="http://blog.andy.fit/tags/Quantum-Vortex/"/>
    
    <category term="MATLAB" scheme="http://blog.andy.fit/tags/MATLAB/"/>
    
  </entry>
  
  <entry>
    <title>「NPMS」Neusoft profit management system</title>
    <link href="http://blog.andy.fit/2021/07/23/NPMS/"/>
    <id>http://blog.andy.fit/2021/07/23/NPMS/</id>
    <published>2021-07-23T10:06:37.000Z</published>
    <updated>2021-11-18T09:34:03.185Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/NPMS/7.png" alt="1"></p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Neusoft Group’s existing profit management system continues to develop and expand with the company’s scale and the increase in the number of users, resulting in an increase in system risk, which affects core management businesses such as financial accounting. The existing system architecture and customized functions can no longer meet the management needs of the company’s sustainable development. Therefore, a more complete profit management system needs to be re-developed. The modules currently under development include customer management module, opportunity management module, and daily report management module. Project and related business management functions need to be further developed.</p><p>The customer management module includes customer management and handover. The opportunity management module includes opportunity maintenance, approval and tracking. Opportunities refer to business opportunities brought by customers. For example, Huawei will launch a new product research and development plan recently. This is an opportunity for Huawei, a customer. As mentioned above, one customer can correspond to multiple opportunities. Daily report management includes employees’ daily daily report filling, leader’s daily report query and other related functions.</p><span id="more"></span><h2 id="My-work"><a href="#My-work" class="headerlink" title="My work"></a>My work</h2><p>I am responsible for the back-end development of the system. First clarify the requirements, design ER diagrams, class diagrams, sequence diagrams and other related models. Then, referring to these diagrams, 33 tables of customers, employees, departments, opportunities, handover logs, etc. were designed. Use MySQL to complete the creation of the database. Use mybatis as the persistence layer framework, and use mybatis-plus to automatically generate controller, service, and mapper.</p><p>After that, I participated in the preparation of all the back-end API documents. Among them, the customer management module has 18 APIs, including the addition, deletion and modification of customers, customer handover, customer freezing, and many secondary linkages and other page functions. The opportunity management module has 19 APIs, including opportunity addition, deletion, modification, inspection, opportunity tracking, opportunity approval, and so on. The daily report management module has 5 APIs, including daily report filling, daily report query and so on.</p><p>I use springcloud when developing, and treat the above three modules, customer management, opportunity management, and daily report management as three independent services, in other words, consumers. The gateway is used for access, and the authorization authentication uses oath2 and spring-security. The entire service includes three eureka servers, one gateway, one oath2-auth and three consumers. I also used redis as a cache database and published the project on the Alibaba Cloud server.</p><h2 id="My-innovation-point"><a href="#My-innovation-point" class="headerlink" title="My innovation point"></a>My innovation point</h2><p>In opportunity approval, multiple approvals by different leaders are involved, and the order of approval is determined. Only after the first approver passes the process will the process proceed to the next person for approval. In addition, the approval results have three results: “pass, reject, and reject the modification”. In order to handle this business, I designed a number of temporary storage tables (buffer) to store the “opportunity” information pending approval. In this way, the original “opportunities” table can not be modified, making the entire approval process safer for database operations.</p><h2 id="Detailed-design"><a href="#Detailed-design" class="headerlink" title="Detailed design"></a>Detailed design</h2><p><strong>The structure of the backend of NPMS</strong></p><p><img src="/images/NPMS/13.png" alt="1"></p><p><img src="/images/NPMS/14.png" alt="1"></p><p><img src="/images/NPMS/15.png" alt="1"></p><p><strong>I used spring-cloud and registered all servers to eureka server, the figure are as follow.</strong></p><p><img src="/images/NPMS/16.png" alt="1"></p><h2 id="System-Implementation"><a href="#System-Implementation" class="headerlink" title="System Implementation"></a>System Implementation</h2><h4 id="1-Customer-Management"><a href="#1-Customer-Management" class="headerlink" title="1. Customer Management"></a>1. Customer Management</h4><ol><li><p>When adding a new customer, I will realize an auto increment by myself, which is select the max customer id from the table and add one.</p></li><li><p> The customer association cannot be associated with multi-level parent nodes. If A-&gt;B, B-&gt;C then A can’t -&gt; C.</p></li></ol><ul><li>If the current customer is D and A and B are added as associated customers, then see if you can find A C in the table where A-&gt;C and B-&gt;C (add, modify)</li><li>If the current customer is D and A and B are added as associated customers, then check the table for A-&gt;B (add, modify)</li><li>If the current customer is D, and if A is added as an associated customer, then see if you can find an E in the table where A-&gt;E and D-&gt;E (modify)</li></ul><ol start="3"><li><p>Using transactions for unified commit or rollback by adding @Transactional (rollbackFor=Exception.class)</p></li><li><p>Key codes</p></li></ol><p><img src="/images/NPMS/1.png" alt="1"></p><br><h4 id="2-Opportunity-Management"><a href="#2-Opportunity-Management" class="headerlink" title="2. Opportunity Management"></a>2. Opportunity Management</h4><h6 id="1-querying-opportunity"><a href="#1-querying-opportunity" class="headerlink" title="1. querying opportunity"></a>1. querying opportunity</h6><img src="/images/NPMS/2.png" alt="1" style="zoom:33%;" /><h6 id="2-adding-opportunity"><a href="#2-adding-opportunity" class="headerlink" title="2. adding opportunity"></a>2. adding opportunity</h6><img src="/images/NPMS/3.png" alt="1" style="zoom: 33%;" /><h6 id="3-updating-opportunity"><a href="#3-updating-opportunity" class="headerlink" title="3. updating opportunity"></a>3. updating opportunity</h6><img src="/images/NPMS/4.png" alt="1" style="zoom:100%;" /><h4 id="3-Approval"><a href="#3-Approval" class="headerlink" title="3. Approval"></a>3. Approval</h4><h6 id="1-Creating-4-new-tables-as-buffer-tables"><a href="#1-Creating-4-new-tables-as-buffer-tables" class="headerlink" title="1. Creating 4 new tables as buffer tables"></a>1. Creating 4 new tables as buffer tables</h6><p>The four tables are created in order to store the inserted or updated opportunity information. They are opportunity_buffer, sub_opportunity_buffer, competitor_buffer and payer_buffer. These four tables are corresponding to the original four tables, which are opportunity, sub_opportunity, competitor, and payer. In this way, I can store the new data in the buffer. When the approval is pass, we will transfer the data from the buffer to the normal table.</p><h6 id="2-Approval-flow-chart"><a href="#2-Approval-flow-chart" class="headerlink" title="2. Approval flow chart"></a>2. Approval flow chart</h6><p><em>(This picture is rather vague, you can download it and see)</em></p><p><img src="/images/NPMS/5.png" alt="1"></p><br><h4 id="4-Oauth2-amp-Gateway"><a href="#4-Oauth2-amp-Gateway" class="headerlink" title="4. Oauth2 &amp; Gateway"></a>4. Oauth2 &amp; Gateway</h4><p>In realizing oauth2 authentication using gateway, I met cross-domain problems which had bothered me for a long time. In the end, I got the answer online that I need to add a configuration file in gateway to allow cross-domain. The sample codes are shown as following. </p><p>Then I considered all the roles of those employees and set the rules of requests url that some rules can or can’t access.</p><p><img src="/images/NPMS/6.png" alt="1"></p><br><h2 id="System-Screenshots"><a href="#System-Screenshots" class="headerlink" title="System Screenshots"></a>System Screenshots</h2><p><img src="/images/NPMS/9.png" alt="1"></p><p><img src="/images/NPMS/10.png" alt="1"></p><p><img src="/images/NPMS/12.png" alt="1"></p><p><img src="/images/NPMS/11.png" alt="1"></p><h2 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h2><p><a href="https://github.com/xsb1999/npms-backend">GitHub</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/NPMS/7.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;Neusoft Group’s existing profit management system continues to develop and expand with the company’s scale and the increase in the number of users, resulting in an increase in system risk, which affects core management businesses such as financial accounting. The existing system architecture and customized functions can no longer meet the management needs of the company’s sustainable development. Therefore, a more complete profit management system needs to be re-developed. The modules currently under development include customer management module, opportunity management module, and daily report management module. Project and related business management functions need to be further developed.&lt;/p&gt;
&lt;p&gt;The customer management module includes customer management and handover. The opportunity management module includes opportunity maintenance, approval and tracking. Opportunities refer to business opportunities brought by customers. For example, Huawei will launch a new product research and development plan recently. This is an opportunity for Huawei, a customer. As mentioned above, one customer can correspond to multiple opportunities. Daily report management includes employees’ daily daily report filling, leader’s daily report query and other related functions.&lt;/p&gt;</summary>
    
    
    
    
    <category term="Maven" scheme="http://blog.andy.fit/tags/Maven/"/>
    
    <category term="Java" scheme="http://blog.andy.fit/tags/Java/"/>
    
    <category term="Spring Boot" scheme="http://blog.andy.fit/tags/Spring-Boot/"/>
    
    <category term="Spring Cloud" scheme="http://blog.andy.fit/tags/Spring-Cloud/"/>
    
    <category term="Spring Security" scheme="http://blog.andy.fit/tags/Spring-Security/"/>
    
    <category term="MyBatis" scheme="http://blog.andy.fit/tags/MyBatis/"/>
    
    <category term="MySQL" scheme="http://blog.andy.fit/tags/MySQL/"/>
    
    <category term="Linux" scheme="http://blog.andy.fit/tags/Linux/"/>
    
    <category term="Nginx" scheme="http://blog.andy.fit/tags/Nginx/"/>
    
    <category term="Docker" scheme="http://blog.andy.fit/tags/Docker/"/>
    
    <category term="Redis" scheme="http://blog.andy.fit/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>「MQAS」Medical QA System Based On Knowledge Graph</title>
    <link href="http://blog.andy.fit/2021/05/08/KG_QA/"/>
    <id>http://blog.andy.fit/2021/05/08/KG_QA/</id>
    <published>2021-05-08T12:27:56.000Z</published>
    <updated>2021-11-18T10:59:15.280Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/QA_KG/1.png" alt="1"></p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>At present, the intelligentization of medical diagnosis in our country needs to be improved. Due to the lack of a convenient and accurate channel for consultation, many patients lack a relatively accurate understanding of their condition. This project is based on knowledge graphs, natural language processing and other related technologies to realize knowledge-driven medical intelligence: preliminary diagnosis of the patient’s text and voice input symptom description, combined with the patient’s past medical history to provide diagnosis-oriented auxiliary decision-making and knowledge services. It realizes an intelligent and relatively accurate channel for patients’ consultation and consultation anytime and anywhere, and reduces the burden of offline manual diagnosis by doctors.</p><span id="more"></span><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="Research-task"><a href="#Research-task" class="headerlink" title="Research task"></a>Research task</h2><h3 id="Flow-chart"><a href="#Flow-chart" class="headerlink" title="Flow chart"></a>Flow chart</h3><img src="/images/QA_KG/2.png" alt="1" style="zoom:36%;" /><p>First, we crawled on the Internet, used vertical websites as data sources, and built a disease-centric medical knowledge map with an entity scale of 30,000 and an entity relationship of 200,000. This project is business-driven to build a medical knowledge graph. The knowledge schema design is generated based on the collected structured data, and the web page structured data is analyzed by xpath. We used the neo4j graph database as storage, and completed the knowledge question and answer based on the character matching of the question, and finally used the cypher query sentence as the question and answer search sql to support the question and answer service.</p><p>At the current stage, this question and answer system supports 15 different types of questions, including: disease symptoms, known symptoms to find possible diseases, causes, complications, foods not to eat, foods to eat, what medicines to take, what checks to be done, preventive measures, Treatment methods and cycles, etc.</p><p>At present, we are trying to add deep learning and natural language processing related content, so as to get rid of the use of keyword matching, because keyword matching has some shortcomings: 1. The types of questions are limited (the user may use a strange questioning method, so Avoid the keywords that we have set in advance: for example, the question of what to eat); 2. The answer is relatively rigid (about the cause of the disease, prevention, etc., the actual return is a large paragraph of text, in fact, the concept of event extraction can be introduced here , And further structure the reasons). So we are currently trying to use NLP to directly identify the entities, relationships, and attributes in the user input questions, and then use the knowledge graph ontology layer to match the results.</p><p>In addition, we are also trying to add voice functions, using some public voice recognition interfaces (free interfaces provided by HKUST IFLYTEK or Baidu AI or Tencent Cloud for developers) to achieve speech recognition and synthesis.</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/QA_KG/1.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;At present, the intelligentization of medical diagnosis in our country needs to be improved. Due to the lack of a convenient and accurate channel for consultation, many patients lack a relatively accurate understanding of their condition. This project is based on knowledge graphs, natural language processing and other related technologies to realize knowledge-driven medical intelligence: preliminary diagnosis of the patient’s text and voice input symptom description, combined with the patient’s past medical history to provide diagnosis-oriented auxiliary decision-making and knowledge services. It realizes an intelligent and relatively accurate channel for patients’ consultation and consultation anytime and anywhere, and reduces the burden of offline manual diagnosis by doctors.&lt;/p&gt;</summary>
    
    
    
    
    <category term="Algorithm" scheme="http://blog.andy.fit/tags/Algorithm/"/>
    
    <category term="Python" scheme="http://blog.andy.fit/tags/Python/"/>
    
    <category term="Machine Learning" scheme="http://blog.andy.fit/tags/Machine-Learning/"/>
    
    <category term="Deep Learning" scheme="http://blog.andy.fit/tags/Deep-Learning/"/>
    
    <category term="Knowledge Graph" scheme="http://blog.andy.fit/tags/Knowledge-Graph/"/>
    
    <category term="Neo4j" scheme="http://blog.andy.fit/tags/Neo4j/"/>
    
  </entry>
  
  <entry>
    <title>「TBM」Intelligent Perception System</title>
    <link href="http://blog.andy.fit/2020/11/30/TBM/"/>
    <id>http://blog.andy.fit/2020/11/30/TBM/</id>
    <published>2020-11-30T13:48:47.000Z</published>
    <updated>2021-11-19T05:10:11.515Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/TBM/TBM1.png" alt="TBM1"></p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>This project is based on the real-time rock-machine interaction data generated by Jilin Yinsong TBM (Tunnel Boring Machine) excavation in the tunnel. The machine learning method is used to detect the danger of the road section ahead during the TBM tunneling, that is, to determine whether there is a collapse or fault in the road section ahead. And remind the driver in time. In the end, our team is committed to developing a system that can accurately control the real-time parameters and road conditions of the TBM during tunnel excavation. The system mainly has three modules: advance prediction of landslides, advance prediction of faults, and real-time data prediction.</p><span id="more"></span><h2 id="Research-task"><a href="#Research-task" class="headerlink" title="Research task"></a>Research task</h2><h4 id="1-Data-preprocessing"><a href="#1-Data-preprocessing" class="headerlink" title="1. Data preprocessing"></a>1. Data preprocessing</h4><p>Use libraries such as numpy and pandas in Python to process the initial data, including modifying the data format, data partitioning, merging, removing outliers and interpolation, etc.</p><h4 id="2-Three-stage-division-normal-early-warning-landslide"><a href="#2-Three-stage-division-normal-early-warning-landslide" class="headerlink" title="2. Three-stage division (normal, early warning, landslide)"></a>2. Three-stage division (normal, early warning, landslide)</h4><p>According to the changes of various rock-machine interaction parameters before the collapse of the TBM during the tunneling process, the tunneling process can be divided into three stages: the normal section, the early warning section, and the collapse section. Among them, the normal section is defined as the normal tunneling section, that is, the tunneling section outside the impact range of the front collapse. During the tunneling process, the TBM machine parameters do not respond to the collapse; the early warning section refers to the area within the impact range of the front collapse. In the tunneling section before the location, the TBM machine parameters will respond to the collapse in this section of the tunneling process; the collapsed section refers to the section where the TBM is tunneling at the location of the collapse.</p><p>The significance of the early warning section is to realize the advance prediction of the landslide. In the process of TBM tunnelling, it is meaningless to predict whether there will be a landslide at the current moment. It is worthy of our study to make an early warning of the landslide ahead. Therefore, I need to mark an early warning segment for these data, so that the data is of three types. What I have to do is to predict whether the current TBM tunneling is an early warning section (essentially a 3-classification problem), and if it is, an alarm will be issued immediately, indicating that there is a possibility of a landslide ahead.</p><p>The problem now is that from the existing data, I can obtain the data of the normal section and the landslide section, but cannot get the data of the early warning section. Therefore, I need to artificially formulate a rule according to the change law of different rock-machine interaction parameters near the landslide. To divide the early warning section.</p><p>The early warning segment is divided by analyzing the rock-machine interaction parameters of TBM before the collapse. Among them, the “cutterhead torque” has the most significant response to the collapse. The cutter head torque will increase sharply before the collapse, and suddenly drop sharply when the torque increases to the maximum value. Therefore, I choose to divide the pre-warning segment with the maximum torque point as the limit, and set the descending segment of the cutter head torque before the collapse area as the pre-warning area (as shown in the figure below).</p><img src="/images/TBM/TBM3.png" alt="TBM1" style="zoom:75%;" /><h4 id="3-Feature-selection-amp-Interpretation-with-SHAP"><a href="#3-Feature-selection-amp-Interpretation-with-SHAP" class="headerlink" title="3. Feature selection &amp; Interpretation with SHAP"></a>3. Feature selection &amp; Interpretation with SHAP</h4><p>Because the rock-machine interaction parameters generated during TBM excavation have very clear physical meanings, these data are all understood in the field of civil engineering, and our instructor is from the School of Civil Engineering. Therefore, instead of directly using traditional machine learning, he is more inclined to adopt an interpretable method, because it can combine machine learning with existing civil engineering knowledge. Therefore, I found SHAP, which can visually display the importance of features and the impact of feature size on the prediction results of machine learning models (for example: when feature A is greater than 5, the model is more inclined to classify a certain point into the first category ; When the feature A is less than 5, the model is more inclined to classify a certain point into the second category). Therefore, I used SHAP and combined the knowledge in the field of civil engineering to initially screen out 20 features.</p><p>After that, I sequentially selected different numbers of features from these 20 features, performed machine learning model training and result evaluation, and finally selected 15 from these 20 features as the final feature.</p><p>The relationship between the features obtained by SHAP and the model results (the larger the SHAP value, the model is more likely to predict 2[collapse], otherwise it tends to predict 0[normal]): </p><p><img src="/images/TBM/TBM4.png" alt="TBM1"></p><p>Feature importance map obtained by SHAP: </p><p><img src="/images/TBM/TBM5.png" alt="TBM1"></p><h4 id="4-Hyperparameter-optimization"><a href="#4-Hyperparameter-optimization" class="headerlink" title="4. Hyperparameter optimization"></a>4. Hyperparameter optimization</h4><p>Hyperparameter optimization in machine learning is very important because it directly determines the result of a model. Because traditional grid search is too slow, I thought of adopting some swarm intelligence optimization algorithms, such as differential evolution algorithm, genetic algorithm, particle swarm algorithm, simulated annealing algorithm, ant colony algorithm, immune optimization algorithm, fish school algorithm and so on.</p><p>After a series of experiments, I found that particle swarm optimization (PSO) is the most suitable for our project. However, although the traditional PSO is better than the others in terms of convergence speed and accuracy, the good is not obvious, so I started to improve the PSO.</p><p>I improved the PSO based on the PSO source code in the open source library scikit-opt (<a href="https://scikit-opt.github.io/scikit-opt/#/docs/en">https://scikit-opt.github.io/scikit-opt/#/docs/en</a>), and improved two versions.</p><h4 id="5-Model-training"><a href="#5-Model-training" class="headerlink" title="5. Model training"></a>5. Model training</h4><p>The advance prediction of landslide is essentially a 3-classification problem (normal-0, warning-1, landslide-2). We tried many machine learning models, logistic regression, SVM, random forest, etc., and compared a series of evaluation indicators such as recall rate, and finally chose lightGBM for prediction. In the end, our prediction accuracy is not bad, with recall reaching about 0.7, as shown in the figure below.</p><img src="/images/TBM/TBM6.png" alt="TBM1" style="zoom:88%;" /><h4 id="6-Use-pyqt-to-develop-Windows-desktop-applications"><a href="#6-Use-pyqt-to-develop-Windows-desktop-applications" class="headerlink" title="6. Use pyqt to develop Windows desktop applications"></a>6. Use pyqt to develop Windows desktop applications</h4><p>Use pyqt to complete the development of desktop applications and realize the functions of three modules: collapse warning, fault warning, and real-time prediction of rock-machine interaction parameters. Below are some screenshots.</p><p><strong>Data preprocessing:</strong> </p><p><img src="/images/TBM/TBM7.png" alt="TBM1"></p><p><strong>Normal period:</strong> </p><p><img src="/images/TBM/TBM8.png" alt="TBM1"></p><p><strong>Warning period:</strong></p><p><img src="/images/TBM/TBM9.png" alt="TBM1"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/TBM/TBM1.png&quot; alt=&quot;TBM1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;This project is based on the real-time rock-machine interaction data generated by Jilin Yinsong TBM (Tunnel Boring Machine) excavation in the tunnel. The machine learning method is used to detect the danger of the road section ahead during the TBM tunneling, that is, to determine whether there is a collapse or fault in the road section ahead. And remind the driver in time. In the end, our team is committed to developing a system that can accurately control the real-time parameters and road conditions of the TBM during tunnel excavation. The system mainly has three modules: advance prediction of landslides, advance prediction of faults, and real-time data prediction.&lt;/p&gt;</summary>
    
    
    
    
    <category term="Algorithm" scheme="http://blog.andy.fit/tags/Algorithm/"/>
    
    <category term="Python" scheme="http://blog.andy.fit/tags/Python/"/>
    
    <category term="Machine Learning" scheme="http://blog.andy.fit/tags/Machine-Learning/"/>
    
    <category term="PSO" scheme="http://blog.andy.fit/tags/PSO/"/>
    
    <category term="SHAP" scheme="http://blog.andy.fit/tags/SHAP/"/>
    
    <category term="PyQt" scheme="http://blog.andy.fit/tags/PyQt/"/>
    
  </entry>
  
  <entry>
    <title>「PSO」Algorithm Improvement</title>
    <link href="http://blog.andy.fit/2020/11/15/PSO/"/>
    <id>http://blog.andy.fit/2020/11/15/PSO/</id>
    <published>2020-11-15T03:08:51.000Z</published>
    <updated>2021-11-19T05:10:02.828Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/TBM/1.gif" alt="TBM1" style="zoom: 150%;" /><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Particle swarm optimization (PSO: Particle swarm optimization) is an evolutionary computation technology. Originated from the study of bird predation behavior. The basic idea of particle swarm optimization algorithm is to find the optimal solution through collaboration and information sharing between individuals in the group. It is simple and easy to implement and does not have many parameter adjustments. It has been widely used in the application fields of function optimization, neural network training, fuzzy system control and other genetic algorithms.</p><p>The particle swarm algorithm simulates the birds in a flock of birds by designing a massless particle. The particle has only two attributes: speed and position. Speed represents the speed of movement, and position represents the direction of movement. Each particle searches for the optimal solution individually in the search space, and records it as the current individual extreme value, and shares the individual extreme value with other particles in the entire particle swarm, and finds the optimal individual extreme value as the entire particle The current global optimal solution of the swarm, all particles in the particle swarm adjust their speed and position according to the current individual extreme value they find and the current global optimal solution shared by the entire particle swarm. </p><p><strong>I made two versions of improvements to the traditional PSO</strong></p><span id="more"></span><h2 id="Improvements"><a href="#Improvements" class="headerlink" title="Improvements"></a>Improvements</h2><h4 id="1-Improvement-purpose"><a href="#1-Improvement-purpose" class="headerlink" title="1. Improvement purpose"></a>1. Improvement purpose</h4><p><em><strong>1) PSO0 —&gt; PSO1</strong></em></p><p><img src="/images/PSO/001.png" alt="img"></p><p>In PSO0, w is a constant, in PSO1, w satisfies the upper formula</p><p>The larger w is, the faster the particle moves, and the larger the span of each movement. Therefore, an appropriate increase in w will shorten the optimization time. But a large w will also bring about problems, that is, the particles may skip the extreme points directly and fail to find the optimal solution.</p><p>Therefore, the particles are classified according to whether the current fitness value is greater than the average fitness value. If the fitness value of the particle is greater than the average value, it means that the particle is still far away from the optimal position. Therefore, we need to make w larger and take ω_max.If less than or equal to the mean, then use <img src="/images/PSO/000.png" alt="img"> </p><p>First of all, because the fitness value of the particle is less than the average value at this time, it means that it is relatively close to the optimal position, so w should be smaller to prevent the particle from skipping the optimal position if w is too large. But this time will bring another problem: falling into a local optimal solution. To solve this problem, I use To solve this problem, I used <img src="/images/PSO/002.png" alt="img"> to constrain the value of ω.</p><p>When the value is large, it means that the average value is very close to the minimum value, that is, the particles are close together and gather at one point. This is likely to be the local optimal solution, so increase w to jump out of this local optimal position. But we can’t make w too large, so we use ω_min to add a part here, which is similar to a penalty factor.</p><p><em><strong>2) PSO1 —&gt; PSO2</strong></em></p><p><img src="/images/PSO/003.png" alt="img"></p><p>In PSO2, I made the following changes to PSO1</p><p><strong>1) Change ω_min to ω_max</strong></p><p>Because in the actual test, it is found that if ω_min is taken, the iteration speed is very slow and often because the value of w is not large enough, it is impossible to jump out of the local optimal position. Therefore, change it to ω_max here, so that w is large enough to speed up the convergence speed and make the particles better jump out of the local optimal position.</p><p><strong>2) Change the product term</strong></p><p>original:  <img src="/images/PSO/004.png" alt="img"></p><p>current: <img src="/images/PSO/005.png" alt="img"> </p><p>When the fitness value of the current particle is close to the average fitness value of all particles, and the average fitness value is very close to the minimum value, it means that all the particles are gathered in one position, and this position may be the local optimal position, so To make w larger, that is, reduce it.</p><p>For the constant of 500, it is an empirical value obtained by me after testing, and it has no practical meaning.</p><h4 id="2-Specific-methods"><a href="#2-Specific-methods" class="headerlink" title="2. Specific methods"></a>2. Specific methods</h4><p><strong>PSO speed and position update formula:</strong></p><p><img src="/images/PSO/009.png" alt="img"> </p><p><img src="/images/PSO/010.png" alt="img"> </p><p><strong>PSO1 inertia weight w update formula:</strong></p><p><img src="/images/PSO/001.png" alt="img"></p><p><strong>PSO2 inertia weight w update formula:</strong></p><p><img src="/images/PSO/003.png" alt="img"></p><p><strong>Flow chart:</strong></p><img src="/images/PSO/008.png" alt="img" style="zoom: 80%;" /><h4 id="3-Improved-effect"><a href="#3-Improved-effect" class="headerlink" title="3. Improved effect"></a>3. Improved effect</h4><p><img src="/images/PSO/LGB.png" alt="img"></p><h2 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h2><p><a href="https://github.com/xsb1999/pso-all">GitHub</a></p>]]></content>
    
    
    <summary type="html">&lt;img src=&quot;/images/TBM/1.gif&quot; alt=&quot;TBM1&quot; style=&quot;zoom: 150%;&quot; /&gt;

&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;Particle swarm optimization (PSO: Particle swarm optimization) is an evolutionary computation technology. Originated from the study of bird predation behavior. The basic idea of particle swarm optimization algorithm is to find the optimal solution through collaboration and information sharing between individuals in the group. It is simple and easy to implement and does not have many parameter adjustments. It has been widely used in the application fields of function optimization, neural network training, fuzzy system control and other genetic algorithms.&lt;/p&gt;
&lt;p&gt;The particle swarm algorithm simulates the birds in a flock of birds by designing a massless particle. The particle has only two attributes: speed and position. Speed represents the speed of movement, and position represents the direction of movement. Each particle searches for the optimal solution individually in the search space, and records it as the current individual extreme value, and shares the individual extreme value with other particles in the entire particle swarm, and finds the optimal individual extreme value as the entire particle The current global optimal solution of the swarm, all particles in the particle swarm adjust their speed and position according to the current individual extreme value they find and the current global optimal solution shared by the entire particle swarm. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;I made two versions of improvements to the traditional PSO&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="Algorithm" scheme="http://blog.andy.fit/tags/Algorithm/"/>
    
    <category term="Swarm intelligence" scheme="http://blog.andy.fit/tags/Swarm-intelligence/"/>
    
    <category term="Python" scheme="http://blog.andy.fit/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>「NeuWeb」A Portfolio Web Application</title>
    <link href="http://blog.andy.fit/2020/10/09/NeuWeb/"/>
    <id>http://blog.andy.fit/2020/10/09/NeuWeb/</id>
    <published>2020-10-09T00:08:11.000Z</published>
    <updated>2021-11-18T11:02:55.697Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/NeuWeb/11.png" alt="6"></p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><strong>It is the final project of the Web Development course. Here comes the requirement.</strong></p><p><em>For this project you want to provide a home page for the web site that describes the</em><br><em>portfolio application and allows a user to create an account. Once a user has created an</em><br><em>account, they should be able to create their portfolio. This will mean providing a form that</em><br><em>allows them to enter details about themselves. These details are to be stored in a database</em><br><em>and then used to display the user’s individual portfolio home page. (Use the structure you</em><br><em>created for your individual portfolio home page as the template for the user’s home page.)</em><br><em>You should be able to reuse the project form and tables from the tutorial exercises. You may</em><br><em>need to modify these to deal with multiple users.</em></p><span id="more"></span><h2 id="Implementation-process"><a href="#Implementation-process" class="headerlink" title="Implementation process"></a>Implementation process</h2><h3 id="1-Database-design"><a href="#1-Database-design" class="headerlink" title="1. Database design"></a>1. Database design</h3><p>I used derby for my database named <strong>myDatabase_Andy</strong> and designed two tables which are<br><code>users</code> and <code>projects</code> . The detailed information of them will be shown in the following tables.</p><p><strong>users:</strong></p><img src="/images/NeuWeb/1.png" alt="1" style="zoom:66%;" /><p><strong>projects:</strong></p><img src="/images/NeuWeb/2.png" alt="2" style="zoom:66%;" /><img src="/images/NeuWeb/3.png" alt="2" style="zoom:66%;" /><h3 id="2-My-implementation"><a href="#2-My-implementation" class="headerlink" title="2. My implementation"></a>2. My implementation</h3><h4 id="a-Big-idea-project-structure"><a href="#a-Big-idea-project-structure" class="headerlink" title="a) Big idea (project structure)"></a>a) Big idea (project structure)</h4><p>My project structure is shown in the picture below.</p><img src="/images/NeuWeb/4.png" alt="4" style="zoom:60%;" /><p>It is a maven project. In <code>java</code> package, there are <code>coreservlets</code> , <code>db_utils</code> , <code>managedbeans</code> and<br><code>utils</code> . In <code>coreservlets</code> , there are two classes for the creation of the database. In <code>db_utils</code><br>there are two classes which are used as the databse util classes for user and project. In<br><code>managedbeans</code> , there are four classes which are all managed beans. Finally, in <code>utils</code> , there is<br>one class used as a <code>util</code> class for the date operation.</p><p>In <code>jsf</code> package, I have these files shown as below.</p><img src="/images/NeuWeb/5.png" alt="4" style="zoom:80%;" /><p>For the class <strong>EmbeddedDbCreator</strong>, I only created one table <strong>projects</strong> in this class, I created the<br>other table <strong>user</strong> with the database GUI in IDEA. </p><p>Thus, please don’t run this class and use the database directly.</p><h4 id="b-Register"><a href="#b-Register" class="headerlink" title="b) Register"></a>b) Register</h4><p>When users want to register, they need to input username, password and a password<br>conformation. If the two password are not the same, they can not register.</p><p>Register page</p><p><img src="/images/NeuWeb/6.png" alt="6"></p><p>For the register, I write a method in <code>DBUtil_user</code> class, adding a user in <code>users</code> table. In class<br><code>User</code> , which is a managed bean, I have a method named register. In it I will first verify whether<br>the two passwords are the same, if not, I will return the error massage to the page. If they are<br>same, I will call the method in <code>DBUtil_user</code> class for the user register.</p><h4 id="c-Login"><a href="#c-Login" class="headerlink" title="c) Login"></a>c) Login</h4><p>When users want to login, they need to input username, password. The program will find this<br>user in the database, if there exist one user whose username and password are both the same as<br>the input, the user will login success and jump to their own home pages.</p><p>The important thing is that, I set the scope of the managed bean User as SessionScoped so that<br>when a user login successful, in the method of User, I will be able to get all information of that<br>user by <code>#&#123;&#125;</code> . In this way, when a user login successful and jump to its home page, the<br>information of him or her will be shown in the page by el expression <code>#&#123;&#125;</code> .</p><p>Let’s use Mike to login</p><p><img src="/images/NeuWeb/7.png" alt="6"></p><p>Because Mike has just register, his information are empty, he can add those detailed information<br>by click the button <code>Click to add or update something about yourself</code></p><h4 id="d-Add-or-update-the-details-of-users’-portfolios"><a href="#d-Add-or-update-the-details-of-users’-portfolios" class="headerlink" title="d) Add or update the details of users’ portfolios"></a>d) Add or update the details of users’ portfolios</h4><p>When a user login successful, it can add or update its detailed information(basic introduction, my<br>interests, my experiences, my skills and my career goals) by click the button Click to add or<br>update something about yourself . After clicking, it will jump to a new page where you can<br>input those information.</p><p>When adding those information, the method in <code>DBUtil_user</code> class to update the information in<br><code>users</code> table will be called. Thus, the information will be added or updated.</p><p>Let’s add some information in Mike’s home page.</p><p><img src="/images/NeuWeb/8.png" alt="6"></p><p>Input details</p><p><img src="/images/NeuWeb/9.png" alt="6"></p><p>Success!</p><p><img src="/images/NeuWeb/10.png" alt="6"></p><p>Back to home page</p><p><img src="/images/NeuWeb/11.png" alt="6"></p><h4 id="e-Add-projects"><a href="#e-Add-projects" class="headerlink" title="e) Add projects"></a>e) Add projects</h4><p>When a user login successful, the program will call another method in <code>DBUtil_project</code> class<br>getting all the projects of that user and use el expression to display on the user’s projects page.</p><p>In users’ projects page, there are a table showing the projects id and titles. When clicking the<br><code>show details</code> button, the detailed information of that project will be shown in the other table<br>below.</p><p>I used js to realize this function, like</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;p_summary&#x27;</span>).innerHTML = <span class="string">&#x27;#&#123;p.summary&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>When users click the button <code>add a project</code> , it will jump to the adding page, users can input<br>their projects details and they should obey the rule of input, like the cost can only be numbers.</p><p>The projects page of Mike</p><p><img src="/images/NeuWeb/12.png" alt="6"></p><p>Add a project</p><p><img src="/images/NeuWeb/13.png" alt="6"></p><p>input the wrong type of date</p><p><img src="/images/NeuWeb/14.png" alt="6"></p><p>Add success</p><p><img src="/images/NeuWeb/15.png" alt="6"></p><p>Back to projects page</p><p><img src="/images/NeuWeb/16.png" alt="6"></p><h4 id="f-Update-projects"><a href="#f-Update-projects" class="headerlink" title="f) Update projects"></a>f) Update projects</h4><p>Users can edit button to <code>edit</code> their projects. The edit function is kind of like the function of<br>adding projects.</p><p>In users’ projects page, there are a table showing the projects id and titles. When clicking the<br><code>show details</code> button, the detailed information of that project will be shown in the other table<br>below. When click the <code>edit</code> button in this table, then the system will jump to the edit page of<br>the project.</p><p>In the edit page, the information of the project will be shown, uses can select and change the<br>things they want to update.</p><p>update Mike’s HIS project (The project id is read only)</p><p><img src="/images/NeuWeb/17.png" alt="6"></p><p>Change the title to HIS_web, change the summary, language, start date and finish date</p><p><img src="/images/NeuWeb/18.png" alt="6"></p><p>Back to projects page (The project is updated)</p><p><img src="/images/NeuWeb/19.png" alt="6"></p><h2 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h2><p><a href="https://github.com/xsb1999/2021NeuWeb">GitHub</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/NeuWeb/11.png&quot; alt=&quot;6&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;It is the final project of the Web Development course. Here comes the requirement.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;For this project you want to provide a home page for the web site that describes the&lt;/em&gt;&lt;br&gt;&lt;em&gt;portfolio application and allows a user to create an account. Once a user has created an&lt;/em&gt;&lt;br&gt;&lt;em&gt;account, they should be able to create their portfolio. This will mean providing a form that&lt;/em&gt;&lt;br&gt;&lt;em&gt;allows them to enter details about themselves. These details are to be stored in a database&lt;/em&gt;&lt;br&gt;&lt;em&gt;and then used to display the user’s individual portfolio home page. (Use the structure you&lt;/em&gt;&lt;br&gt;&lt;em&gt;created for your individual portfolio home page as the template for the user’s home page.)&lt;/em&gt;&lt;br&gt;&lt;em&gt;You should be able to reuse the project form and tables from the tutorial exercises. You may&lt;/em&gt;&lt;br&gt;&lt;em&gt;need to modify these to deal with multiple users.&lt;/em&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="JavaScript" scheme="http://blog.andy.fit/tags/JavaScript/"/>
    
    <category term="JSF" scheme="http://blog.andy.fit/tags/JSF/"/>
    
    <category term="HTML" scheme="http://blog.andy.fit/tags/HTML/"/>
    
    <category term="CSS" scheme="http://blog.andy.fit/tags/CSS/"/>
    
    <category term="Apache Derby" scheme="http://blog.andy.fit/tags/Apache-Derby/"/>
    
    <category term="Maven" scheme="http://blog.andy.fit/tags/Maven/"/>
    
  </entry>
  
  <entry>
    <title>「RRT」Three types of Rapid-exploration Random Tree</title>
    <link href="http://blog.andy.fit/2020/09/19/RRT/"/>
    <id>http://blog.andy.fit/2020/09/19/RRT/</id>
    <published>2020-09-19T04:16:17.000Z</published>
    <updated>2021-11-17T14:07:27.555Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/RRT/1.gif" alt="1"></p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>RRT is a path planning method using in autonomous driving based on sampling. It can quickly search the entire state space (the real world) and is biased towards the unexplored space. It is very similar to trees with lots of limbs stretching out at each time. The main working flow is that we start from the start position and protrude some limbs randomly, once the limb of the tree reaches the destination, the path is found successfully.</p><p><strong>Pros:</strong></p><ol><li><p>It is fast because of the random sampling, which means we don’t need to search for the whole map.</p></li><li><p>It is fast because of the random sampling, which means we don’t need to search for the whole map.</p></li></ol><p><strong>Cons:</strong></p><ol><li><p>Because of the random sampling of points, there always exist lots of redundant points which will make the path longer.</p></li><li><p>The quality of the paths is not good as well, always straight lines with lots of corners. In other words, it’s not smooth enough for real vehicles to drive in the real world.</p></li></ol><span id="more"></span><h2 id="Algorithm"><a href="#Algorithm" class="headerlink" title="Algorithm"></a>Algorithm</h2><p><img src="/images/RRT/3.png" alt="1"></p><p><strong>Steps:</strong></p><ol><li>Sampling a point randomly and call it q_rand.</li><li>Traversing the present tree and find the point in the tree which is nearest to q_rand and call it q_near.</li><li>Extend q_near in the direction of q_rand by a parameter called expandDis set by us thus get q_new.</li><li>Judging whether the limb q_near-q_new collides with those blocks. If not, we retain q_new. Instead, we drop it.</li><li>Repeat doing these four steps mentioned above and when q_new is the destination, we get the path.</li></ol><p><strong>My improvement:</strong></p><p>Because of the random sampling, the final path always contains many points which mean the distance is longer than necessary.</p><p>Thus, I come up with a method called Pruning which means I will cut down those redundant limbs to get a shorter path with less point.</p><p><img src="/images/RRT/4.png" alt="1"></p><h2 id="My-Result-of-RRT"><a href="#My-Result-of-RRT" class="headerlink" title="My Result of RRT"></a>My Result of RRT</h2><img src="/images/RRT/5.gif" alt="1" style="zoom:55%;" /><h2 id="RRT"><a href="#RRT" class="headerlink" title="RRT*"></a>RRT*</h2><p>Although the RRT algorithm is a relatively high-efficiency algorithm that can handle path planning problems and has great advantages in many aspects, the RRT algorithm does not guarantee that the feasible path obtained is relatively optimized.</p><p>Therefore, many improvements on the RRT algorithm are also dedicated to solving the problem of path optimization and the RRT* algorithm is one of them.</p><h3 id="Algorithm-of-RRT"><a href="#Algorithm-of-RRT" class="headerlink" title="Algorithm of RRT*"></a>Algorithm of RRT*</h3><p><strong>1) Choosing parent</strong></p><p><img src="/images/RRT/6.png" alt="1"></p><p>After getting X_new, we will draw a circle with it as the center with a radius of r set by us. This circle will cover some points which mean all those points are not very far from X_new and can be considered to be its parent node. The thing we have to do next is calculate the cost of each candidate. The cost is the distance from the starting point to X_new passing those candidates, which is Distance(X_new-X_candidate )+Distance(X_candidate-X_start ). After calculating all the costs of all candidates, we choose the candidate with the lowest cost as the parent node of X_new.</p><p><strong>2) Rewire</strong></p><p><img src="/images/RRT/7.png" alt="1"></p><p>After confirming the final parent of X_new, it’s time to find its children. We use the former circle again but this time, instead of calculating the distance form the starting point to X_new, we calculate the distance from the starting point to those two green points shown in the figure above, they are the points in the realm of the circle excluding the parent node of X_new. In the figure above, we can see that the upper green node changes its parent from the other green point to X_new because of the lower cost.</p><h3 id="My-Result-of-RRT-1"><a href="#My-Result-of-RRT-1" class="headerlink" title="My Result of RRT*"></a>My Result of RRT*</h3><img src="/images/RRT/8.gif" alt="1" style="zoom:55%;" /><h2 id="RRT-connect"><a href="#RRT-connect" class="headerlink" title="RRT-connect"></a>RRT-connect</h2><p>Because the original RRT starts from one node (the starting point) to build the tree, it’s a little bit slow. So, we can adopt another method which starts both from the starting point and the destination. In this way, with the two trees building simultaneously, the speed will accede a lot.</p><h3 id="Algorithm-of-RRT-connect"><a href="#Algorithm-of-RRT-connect" class="headerlink" title="Algorithm of RRT-connect"></a>Algorithm of RRT-connect</h3><p><img src="/images/RRT/9.png" alt="1"></p><p>In each iteration, the initial step is the same as the original RRT algorithm, which is to sample random points and then expand. After getting the new node X_new from the first tree, the next step is to make X_new as the “random node” sampled by the second tree, so that the second tree will be able to grow towards the first one.</p><p>The tricky point here is that we always use the smaller tree as the expander which means it’s always the small tree growing towards the larger one. The reason is that it can speed up the searching (we need to search for the nearest nodes in the tree).</p><p>Finally, when two nodes from each tree join together, the two trees connected to one path which is our goal path.</p><h3 id="My-Result-of-RRT-connect"><a href="#My-Result-of-RRT-connect" class="headerlink" title="My Result of RRT-connect"></a>My Result of RRT-connect</h3><img src="/images/RRT/10.png" alt="1" style="zoom:60%;" /><img src="/images/RRT/11.png" alt="1" style="zoom:60%;" /><h2 id="Comparison-of-RRT-RRT-and-RRT-connect"><a href="#Comparison-of-RRT-RRT-and-RRT-connect" class="headerlink" title="Comparison of RRT, RRT* and RRT-connect"></a>Comparison of RRT, RRT* and RRT-connect</h2><p>My output is like the figure below, total trying times means the amount of times the tree expands and total running time means the time taken to find the path.</p><p>I calculated ten times for each of the three method recording the average time of them and write them into the form below.</p><img src="/images/RRT/12.png" alt="1" style="zoom:60%;" /><p>From the form we can see that RRT* is better than RRT in both total trying times and total running times. The total trying times of RRT-connect is so much may be because of my code, The standard of two trees join together at one point is distance between the two points are not more then 0.05, maybe I can loose that limitation a little bit.</p><p>In addition, the total running time of RRT-connect is much less than the other two because it has two tree working together for a goal.</p><h2 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h2><p><a href="https://github.com/xsb1999/RRT">GitHub</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/RRT/1.gif&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;RRT is a path planning method using in autonomous driving based on sampling. It can quickly search the entire state space (the real world) and is biased towards the unexplored space. It is very similar to trees with lots of limbs stretching out at each time. The main working flow is that we start from the start position and protrude some limbs randomly, once the limb of the tree reaches the destination, the path is found successfully.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pros:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;It is fast because of the random sampling, which means we don’t need to search for the whole map.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;It is fast because of the random sampling, which means we don’t need to search for the whole map.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Cons:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Because of the random sampling of points, there always exist lots of redundant points which will make the path longer.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The quality of the paths is not good as well, always straight lines with lots of corners. In other words, it’s not smooth enough for real vehicles to drive in the real world.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    
    <category term="Algorithm" scheme="http://blog.andy.fit/tags/Algorithm/"/>
    
    <category term="Python" scheme="http://blog.andy.fit/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>「HIS」Neusoft Cloud Medical System</title>
    <link href="http://blog.andy.fit/2020/07/17/HIS/"/>
    <id>http://blog.andy.fit/2020/07/17/HIS/</id>
    <published>2020-07-17T10:16:06.000Z</published>
    <updated>2021-11-18T11:01:53.598Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/HIS/50.png" alt="1"></p><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>The system developed in this practice project is the outpatient module in Neusoft Cloud Hospital Management System, which includes the following business functions.</p><p>• Patient registration<br>• Patient withdrawal number<br>• Doctor visits<br>• The doctor distributes medicine<br>• Patient payment<br>• Dispensing medicine at the pharmacy</p><p><strong>My work :</strong> </p><p>The front-end page part uses Bootstrap framework, part uses Axure to design and typeset the page; the back-end uses SpringBoot framework, uses Mybatis as the persistence layer framework, and uses Thymeleaf as the template engine to realize the front-end and back-end interaction; uses JavaScript, jQuery and Ajax to achieve related Perfect function.</p><span id="more"></span><h2 id="Relevant-Technologies"><a href="#Relevant-Technologies" class="headerlink" title="Relevant Technologies"></a>Relevant Technologies</h2><h3 id="1-Theoretical-basis"><a href="#1-Theoretical-basis" class="headerlink" title="1. Theoretical basis"></a>1. Theoretical basis</h3><p><strong>a) Spring Boot backend framework and Thymeleaf template engine</strong></p><p>The core idea of Spring Boot is the separation of front and back ends and the development of annotations. Thymeleaf is used as a template engine, and Thymeleaf syntax is used to mark the HTML pages on the front end. In the back end, the controller can be used to obtain front-end data or assign values to the front-end data, and then perform operations. (Write/update database…), in this way, the separation and interaction between front and back ends are realized. In this way, you can omit the Dao layer and the Service layer in the original SSM framework, and interact with the front end directly in the controller.</p><p><strong>b) Mybatis persistence layer framework</strong></p><p>You can use Mybatis to operate the database more conveniently. Write the sql statement directly in mapper.xml, and then map it to a mapper class to directly call sql. There is no need to create a BaseDao class on the Dao layer to control the database like the original jdbc. The connection and the preparation of sql statements. In this way, it not only greatly simplifies the complexity of interacting with the database, but also makes the entire structure clear (1 mapper corresponds to 1 function).</p><p><strong>c) Configuration classes under the config package</strong></p><p>Under the config package, there is a configuration class named MyMvcConfig, which implements the WebMvcConfigurer interface and rewrites the addViewControllers() method, so that multiple different URLs can be set for the same HTML page; in addition, in springboot , MyMvcConfig can also set url for all HTML files in the template package.</p><p><strong>d) Interceptor</strong></p><p>Mainly implemented in the login function part, it is a permission interception; if the user does not enter the correct user name and password, they will be forced to return to the login page when they enter the web page directly. The function of the interceptor is to intercept resources in a targeted manner and intercept requests that do not meet the requirements. In the project, realize the requirement that users must log in first.</p><h3 id="2-Project-development-method"><a href="#2-Project-development-method" class="headerlink" title="2. Project development method"></a>2. Project development method</h3><ul><li>The project adopts an incremental development method, that is, multiple iterations, each iteration realizes the function of a module</li><li>After each increment is completed, the module should be tested. For example, after completing the registration module, you need to register a number for testing, and see if there is a new patient registration information in the registration form in the database. If there is an error, find the cause immediately and modify it. (It is important to ensure the correctness of a single function, because it is relatively easy to modify a single function, but it is difficult to modify after all integration)</li><li>After completing several modules with relatively large correlations, perform integration tests on these modules, for example, from registration to consultation (after registration, a new patient will be added to the doctor’s waiting list). If there is an error, find the cause immediately and modify it.</li><li>After all modules are implemented, a general test is performed. (It is best not to make mistakes, otherwise a lot of changes will be required and the workload will increase sharply)</li></ul><h3 id="3-Development-tools"><a href="#3-Development-tools" class="headerlink" title="3. Development tools"></a>3. Development tools</h3><p>IntelliJ  IDEA 2020.1.2</p><h3 id="4-Development-Environment"><a href="#4-Development-Environment" class="headerlink" title="4. Development Environment"></a>4. Development Environment</h3><p><strong>Operating system</strong>: win7 Professional Edition<br><strong>Browser</strong>: Chrome<br><strong>Operating environment</strong>: jdk1.8, Spring Boot 2.3.1</p><br><h2 id="System-Analysis"><a href="#System-Analysis" class="headerlink" title="System Analysis"></a>System Analysis</h2><p><img src="/images/HIS/1.png" alt="1"></p><h3 id="1-User-login"><a href="#1-User-login" class="headerlink" title="1. User login"></a>1. User login</h3><p><strong>a) Business analysis</strong></p><ul><li>The user logs in on the login page. If the user name and password are correct, enter the user’s page, otherwise it prompts: “User name or password is wrong!”.</li><li>If you visit other pages directly without logging in, you will be bounced back to the login page to log in and display: “No permission, please log in first!”</li></ul><p><strong>b) Functional analysis</strong></p><p><strong>1. Login Interceptor:</strong></p><p>If the user is not logged in and directly accesses an internal page, you need to determine whether the SessionUser attribute exists in the current Session. If it exists (not empty), you can let it go, if it does not exist (not empty), then intercept and jump directly to the login page , And display: “No permission, please log in first!”</p><p><strong>2. User name and password verification:</strong></p><p>After the user enters the user name and password, click the “OK” button to start verification. The back-end uses the controller to requestParam from the front-end page (getting the user name and password entered by the user), and then to the user table in the database to query whether there is a user whose user name and password match the input. If the user exists, add the attributes of the user’s composition Session to the Session; if the user does not exist, it will display “Username or password error!”</p><h3 id="2-Registration"><a href="#2-Registration" class="headerlink" title="2. Registration"></a>2. Registration</h3><p><strong>a) Business analysis</strong></p><ul><li>Patients need to enter personal information such as name, ID number, gender, birthday, and home address when registering, and select the department, number, corresponding doctor, as well as the date of visit and the date of registration.</li><li>If the patient misses the information, it will display: “Registration failed, the information is incomplete!”</li></ul><p><strong>b) Functional analysis</strong></p><p><strong>1. Generate medical record number and invoice number:</strong></p><p>After entering the registration page, a 6-digit medical record number and a 6-digit invoice number will be automatically generated. The principle of generation is to generate randomly. If there is a repetition, add 1 until there is no repetition, which is similar to linear detection when resolving hash conflicts.</p><p><strong>2. Use JS to achieve the following functions:</strong></p><p>(1) Calculate age based on the date of birth entered.<br>(2) Department, number, doctor, three-level linkage.<br>(3) Calculate the registered amount based on the number and whether the medical records are needed.</p><p><strong>3. Write the registration information into the registration form in the database:</strong></p><p>The registration information entered by the front-end user is obtained in the registration controller, and then the patient information is written into the patient form, and then the registration information is written into the registration form. The consultation status in the registration form is 2 (not diagnosed).</p><h3 id="3-Retire"><a href="#3-Retire" class="headerlink" title="3. Retire"></a>3. Retire</h3><p><strong>a) Business analysis</strong></p><ul><li>Patients can only withdraw their numbers when they have not been diagnosed.</li><li>Patients cannot withdraw their account numbers when they have been diagnosed.</li><li>Patients cannot withdraw the number for the second time in the state of withdrawal.</li></ul><p><strong>b) Functional analysis</strong></p><p><strong>1. Enter the patient’s medical record number for query, and get the patient’s registration information:</strong></p><p>The back-end account number controller obtains the medical record number entered by the front-end user, queries the registration information in the database, and then uses Thymeleaf to transmit the information to the front-end page.</p><p><strong>2. Determine whether you can withdraw your account:</strong></p><p>Use JS to determine the value of the registered status. If it is “not diagnosed”, the account can be withdrawn, if it is “diagnosed” or “withdrawn”, the message “cannot return the account!” will pop up.</p><h3 id="4-Doctor-visits"><a href="#4-Doctor-visits" class="headerlink" title="4. Doctor visits"></a>4. Doctor visits</h3><p><strong>a) Business analysis</strong></p><ul><li>When the doctor sees the patient, he can fill in the description information to the “medical record home page” according to the patient’s condition, including: chief complaint, current medical history, current medical treatment, past history, allergy history, physical examination; the doctor can check the waiting time The list of patients who have been diagnosed and the list of patients who have been diagnosed, and the patients can be selected for consultation.</li><li>After the doctor clicks the “Submit” button, the system will write the diagnostic information into the medical record in the database, and change the consultation status in the registration form to 1 (diagnosed).</li></ul><p><strong>b) Functional analysis</strong></p><p><strong>1. Display the list of undiagnosed patients and the list of diagnosed patients:</strong></p><p>In the visit controller, get the undiagnosed and diagnosed patient lists of the current doctor (you can get the name of the current doctor from the Session) from the database, and then addAttribute to the model in the controller (undiagnosed list and diagnosed list) ), and then get the two lists on the front end, and use Thymeleaf to loop output to the two tables.</p><p><strong>2. Select the patient and confirm the consultation:</strong></p><p>In the list of undiagnosed and diagnosed patients, there is a check box at the end of each row. The doctor clicks the check box to confirm the start of the consultation, and then the current patient’s information (name + medical record number) will be displayed on the page. If you do not select a patient to start the consultation directly, it will prompt “Please select 1 patient!”</p><p><strong>3. Click Submit, write the medical record form, and update the consultation status:</strong></p><p>After the doctor finishes writing the diagnosis information, click the “Submit” button, and the back-end consultation controller will obtain the diagnosis information and write it into the medical record form, and change the consultation status in the registration form to 1 (diagnosed).</p><h3 id="5-Prescribe-medication"><a href="#5-Prescribe-medication" class="headerlink" title="5. Prescribe medication"></a>5. Prescribe medication</h3><p><strong>a) Business analysis</strong></p><ul><li>Doctors can prescribe medications based on existing templates, or create new prescriptions and delete prescriptions.</li><li>Doctors can click on the “Show” button of each prescription to view the drug details in the prescription.</li><li>Finally, the doctor selects the prescription to be issued and adds it to the outpatient prescription first, and then clicks the “Issuing” button to complete the issuance of the prescription.</li></ul><p><strong>b) Functional analysis</strong></p><p><strong>1. Add new prescriptions:</strong></p><p>The doctor can add prescriptions. Click the “Add prescriptions” button, enter the name of the new prescription, and then select drugs (up to 5 types) to complete the prescription augmentation operation.</p><p><strong>2. Delete prescriptions:</strong></p><p>The doctor can delete the prescription, click the “Delete prescription” button, enter the prescription name, the prescription will be deleted.</p><p><strong>3. Add to outpatient prescription:</strong></p><p>The doctor clicks the “use” button of each line of prescription to add the prescription to the patient’s outpatient prescription. The doctor can delete prescriptions from the added prescriptions.</p><p><strong>4. Issuing:</strong></p><p>If a doctor wants to prescribe multiple prescriptions, he needs to prescribe multiple prescriptions, and can only prescribe one prescription each time. After the issuance, the issued prescription information will be written into the patient’s prescription list. The drug status in the table is “Undistributed Medicine”, and the payment status is “Unpaid”.</p><h3 id="6-Charges"><a href="#6-Charges" class="headerlink" title="6. Charges"></a>6. Charges</h3><p><strong>a) Business analysis</strong></p><ul><li>The toll collector enters the patient’s medical record number to query all the drug information for the patient’s payment on behalf of the patient.</li><li>Patients choose the drugs to be paid to complete the payment.</li></ul><p><strong>b) Functional analysis</strong></p><ol><li>Enter the patient’s medical record number, you can query the patient’s drug list for payment on behalf of the patient.</li><li>For the drug list, there is a check box at the end of each line, you can select all with one click and pay all the fees, or you can select only a part of them for payment.</li><li>Only unpaid medicines will be displayed in the medicine list, and paid medicines will not be displayed.</li><li>After selecting the drugs to be paid, click the “Confirm Drugs and Amount” button, and the total amount of the currently selected drugs and the payment on behalf of the drug will be displayed.</li><li>Click Settlement to pop up an invoice confirmation window. Click the “Get Invoice Information” button to automatically generate a six-digit invoice number, and display the current patient information, the name of the drug paid and the amount receivable.</li><li>Click the “Charge” button to complete the charge, update the payment status in the patient prescription list to “paid”, add a payment record to the payment list, and add an invoice record to the invoice table middle.</li></ol><h3 id="7-Dispensing-medicine-in-pharmacy"><a href="#7-Dispensing-medicine-in-pharmacy" class="headerlink" title="7. Dispensing medicine in pharmacy"></a>7. Dispensing medicine in pharmacy</h3><p><strong>a) Business analysis</strong></p><ul><li>The pharmacy administrator enters the patient’s medical record number, and queries all the drugs to be issued for the patient.</li><li>Distribute all medicines.</li></ul><p><strong>b) Functional analysis</strong></p><ol><li>In the patient’s list of drugs to be issued, all drugs have been paid.</li><li>One-click to select all medicines and distribute them all directly.</li></ol><br><h2 id="System-Design"><a href="#System-Design" class="headerlink" title="System Design"></a>System Design</h2><h3 id="System-architecture-design"><a href="#System-architecture-design" class="headerlink" title="System architecture design"></a>System architecture design</h3><p>Use the Springboot framework, Mybatis as the persistence layer framework, and Thymeleaf as the template engine</p><p>Spring boot can run independently in the form of a jar package. To run a Spring Boot project, you only need to run it through java -jar xx.jar. Springboot almost eliminates all configuration files. Compared with ordinary web development, Springboot has no web.xml, no need to configure servlet, and it also simplifies the configuration of Maven. When I create a new springboot project, I can manually select the functions and dependencies that I want to add. This saves a lot of the process of adding dependencies in Maven. In other words, springboot takes what you need from the beginning Once the dependencies are installed, you can run them directly after you get them. In addition, the embedded Tomcat is also faster and more convenient to start.</p><p>Thymeleaf, as the template engine recommended by springboot, embeds static html into tag attributes, so that the browser can directly open the template file, which is convenient for front-end and back-end joint debugging. Thymeleaf tags are a major feature. When the backend does not pass values to the frontend, the browser ignores undefined tag attributes when interpreting html, so thymeleaf templates can run statically; when data is returned to the page, Thymeleaf tags Will dynamically replace the static content, so that the page is displayed dynamically. Thymeleaf uses tag attributes to define the template, without destroying the basic html document structure, so that you can directly open it in the browser to view the layout effect. The syntax of Thymeleaf is relatively simple and easy to understand, and the functions are relatively powerful. In short, one sentence is: the template is the prototype, and the front and back ends are separated.</p><p>Use Thymeleaf grammar to mark up the HTML page on the front end. In the back end, you can use the controller to get the front-end data or assign values to the front-end data, and then perform operations (write/update the database…), thus realizing the separation and separation of the front and back ends. Interactive. In this way, you can omit the Dao layer and the Service layer in the original SSM framework, and interact with the front end directly in the controller.</p><p>MyBatis’s encapsulation of jdbc makes data more secure and simplifies data access. You can use Mybatis to operate the database more conveniently. Write the sql statement directly in mapper.xml, and then map it to a mapper class to directly call sql. There is no need to create a BaseDao class on the Dao layer to control the database like the original jdbc. The connection and the preparation of sql statements. In this way, it not only greatly simplifies the complexity of interacting with the database, but also makes the entire structure clear (1 mapper corresponds to 1 function).</p><img src="/images/HIS/2.png" alt="1" style="zoom:80%;" /><h3 id="Detailed-design"><a href="#Detailed-design" class="headerlink" title="Detailed design"></a>Detailed design</h3><p><strong>1) Login and logout</strong></p><p>The user needs to enter the user name and password when logging in. After the LoginController obtains the user input from the front-end page, it calls the method in UserMapper, queries the database for the user name and password as the user object entered by the user, and returns it. In LoginController, if the returned user is not null, it means that the user input is correct, so you can log in and store the user’s information in the session. When the user logs out, he must log out of the session and return to the login page. The interceptor is triggered every time the user makes a page jump. If the user is not logged in, the interceptor intercepts all the redirect requests of the user and jumps to the login page.</p><p><strong>2) Registration</strong></p><p>RegisterController obtains the registration information entered by the patient from the registration page, and calls the method in RegisterMapper to insert a new registration information into the registration form.</p><p><strong>3) Retire</strong></p><p>The operator enters the patient’s medical record number for query, and TuiHaoController obtains the patient’s medical record number from the return number page and calls the method in TuiHaoMapper to find the patient whose medical record number is the medical record number in the registration form. After that, the data is transmitted to the front-end page through Thymeleaf. Use JS on the front end to determine whether the patient can withdraw the number. If so, TuiHaoController will call the method in TuiHaoMapper again to update the patient’s consultation status to “returned number”.</p><p><strong>4) Doctor visits</strong></p><p>KanZhenController calls the method in KanZhenMapper to query the undiagnosed patient list and the diagnosed patient list of the doctor in the current session, and use Thymeleaf to display it on the doctor page.</p><p>After the doctor submits the consultation, KanZhenController calls the method in KanZhenMapper again to add a piece of medical record information to the patient’s medical record table.</p><p><strong>5) Prescribe medication</strong></p><p>When the doctor selects the beneficial party and clicks to issue, KaiYaoController calls the method in KaiYaoMapper to add the prescription details to the patient prescription list.</p><p><strong>6) Charges</strong></p><p>When the operator enters the medical record number to query the patient, PayController calls the method in PayMapper to find the patient based on the medical record number, and transmits the data to the front end. The patient selects the drug to be paid, and after clicking the charge, PayController calls the method in PayMapper again, writes the payment records into the payment schedule one by one, and adds the invoice record to the invoice table.</p><p><strong>7) Dispensing medicine in pharmacy</strong></p><p>Similarly, the operator inputs the patient’s medical record number, and FaYaoController calls the method in FaYaoMapper to find the patient’s list of medicines to be sent based on the medical record number, and transmits the data to the front end. One-click to select all medicines and distribute them directly. FaYaoController calls the method in FaYaoMapper again to update the status of the corresponding medicines to “drugs dispensed”.</p><br><h2 id="System-Implementation"><a href="#System-Implementation" class="headerlink" title="System Implementation"></a>System Implementation</h2><h3 id="1-Login"><a href="#1-Login" class="headerlink" title="1. Login"></a>1. Login</h3><p><img src="/images/HIS/3.png" alt="1"></p><ul><li>The user needs to enter the user name and password when logging in. After the LoginController obtains the user input from the front-end page, it calls the method in UserMapper, queries the database for the user name and password as the user object entered by the user, and returns it. In LoginController, if the returned user is not null, it means that the user input is correct, so you can log in and save the user’s information in the session</li><li>When the user logs out, log out of the session and return to the login page</li></ul><h3 id="2-Registration-1"><a href="#2-Registration-1" class="headerlink" title="2. Registration"></a>2. Registration</h3><p><img src="/images/HIS/4.png" alt="1"></p><ul><li>Patients need to enter personal information such as name, ID number, gender, birthday, and home address when registering, and select the department, number, corresponding doctor, as well as the date of visit and the date of registration.</li><li>If the patient misses the information, it will display: “Registration failed, the information is incomplete!”</li><li>Calculate age based on the date of birth entered.</li><li>Department, number, doctor, three-level linkage.</li><li>Calculate the registered amount based on the number and the need for medical records.</li></ul><h3 id="3-Retire-1"><a href="#3-Retire-1" class="headerlink" title="3. Retire"></a>3. Retire</h3><p><img src="/images/HIS/5.png" alt="1"></p><ul><li>The operator enters the patient’s medical record number to query, and obtains the patient’s registration information: the back-end account controller obtains the medical record number entered by the front-end user, queries the registration information in the database, and then uses Thymeleaf to transmit the information to the front-end page .</li><li>Judging whether the number can be withdrawn: Use JS to judge the value of the registered status, if it is “not diagnosed”, the number can be withdrawn, if it is “diagnosed” or “withdrawn”, the message “cannot return the number!”</li></ul><h3 id="4-Doctor-visits-1"><a href="#4-Doctor-visits-1" class="headerlink" title="4. Doctor visits"></a>4. Doctor visits</h3><p><img src="/images/HIS/6.png" alt="1"></p><ul><li>In the consultation controller, get the undiagnosed and diagnosed patient lists of the current doctor (you can get the name of the current doctor from the Session) from the database, and then addAttribute to the model in the controller (undiagnosed list and diagnosed) list), and then get the two lists on the front end, and use Thymeleaf to loop output to the two tables.</li><li>In the list of undiagnosed and diagnosed patients, there is a check box at the end of each line. The doctor clicks the check box to confirm the start of the consultation, and then the current patient’s information (name + medical record number) will be displayed on the page . If you do not select a patient to start the consultation directly, it will prompt “Please select 1 patient!</li><li>After the doctor finishes writing the diagnosis information, click the “Submit” button, the back-end consultation controller will obtain the diagnosis information and write it into the medical record form, and change the consultation status in the registration form to 1 (diagnosed).</li></ul><h3 id="5-Prescribe-medication-1"><a href="#5-Prescribe-medication-1" class="headerlink" title="5. Prescribe medication"></a>5. Prescribe medication</h3><p><img src="/images/HIS/7.png" alt="1"></p><ul><li>Doctors can prescribe medications based on existing templates, or create new prescriptions and delete prescriptions.</li><li>Doctors can click on the “Show” button of each prescription to view the drug details in the prescription.</li><li>Finally, the doctor chooses the prescription to be issued and adds it to the outpatient prescription first, and then clicks the “Issuing” button to complete the issuance of the prescription.</li><li>After the issuance, all prescribed medicines need to be written into the patient prescription list in the database</li></ul><h3 id="6-Charges-1"><a href="#6-Charges-1" class="headerlink" title="6. Charges"></a>6. Charges</h3><p><img src="/images/HIS/8.png" alt="1"></p><img src="/images/HIS/9.png" alt="1" style="zoom:67%;" /><ul><li>The operator enters the patient’s medical record number, and can query the list of drugs paid on behalf of the patient. For the drug list, there is a check box at the end of each line. You can select all with one click and pay all the fees, or you can select only a part of them for payment.</li><li>After selecting the drugs to be paid, click the “Confirm Drugs and Amount” button, and the total amount of the currently selected drugs and the payment will be displayed.</li><li>Clicking on the settlement will pop up the invoice confirmation window, and clicking the “Get Invoice Information” button will automatically generate a six-digit invoice number, and display the current patient information, the name of the drug paid and the amount receivable.</li><li>Click the “Charge” button to complete the charge, update the payment status in the patient prescription list to “paid”, add a payment record to the payment list, and add an invoice record to the invoice table .</li></ul><h3 id="7-Dispensing-medicine-in-pharmacy-1"><a href="#7-Dispensing-medicine-in-pharmacy-1" class="headerlink" title="7. Dispensing medicine in pharmacy"></a>7. Dispensing medicine in pharmacy</h3><p><img src="/images/HIS/10.png" alt="1"></p><ul><li>The pharmacy administrator enters the patient’s medical record number, and queries all the drugs to be issued for the patient.</li><li>In the patient’s list of drugs to be distributed, all drugs have been paid.</li><li>One-click to select all medicines and distribute them all directly.</li><li>After the medicine is issued, the status of the medicine in the patient prescription list in the database is updated to “drug already issued”</li></ul><br><h2 id="System-Testing"><a href="#System-Testing" class="headerlink" title="System Testing"></a>System Testing</h2><h3 id="1-Login-1"><a href="#1-Login-1" class="headerlink" title="1. Login"></a>1. Login</h3><p>login page: localhost:8080</p><p><img src="/images/HIS/11.png" alt="1"></p><p>When you visit the doctor page directly when you are not logged in, you will be forced to bounce back to the login page.</p><p><img src="/images/HIS/12.png" alt="1"></p><h3 id="2-Registration-2"><a href="#2-Registration-2" class="headerlink" title="2. Registration"></a>2. Registration</h3><p>Register Xu Qiang</p><p><img src="/images/HIS/13.png" alt="1"></p><p>According to different departments, there are different doctors</p><img src="/images/HIS/14.png" alt="1" style="zoom:75%;" /><p>After filling in the registration information, click the “Confirm Registration Information” button, the age will be automatically calculated based on the date of birth, and the amount receivable will be calculated based on the number and whether the medical record is needed.</p><p><img src="/images/HIS/15.png" alt="1"></p><h3 id="3-Doctor-visits"><a href="#3-Doctor-visits" class="headerlink" title="3. Doctor visits"></a>3. Doctor visits</h3><p>Enter the page of Doctor Bianque (user name: bianque, password: bianque123). You can see that Xu Qiang, who has just registered, has appeared in the list of undiagnosed patients of Bian Que.</p><p><img src="/images/HIS/16.png" alt="1"></p><p>If a doctor wants to see a doctor, he needs to check a patient and click the “Start seeing” button.</p><p>(1) If the doctor does not select a patient and directly clicks the “Start Seeing” button, a message will be displayed:</p><p><img src="/images/HIS/17.png" alt="1"></p><p>(2) After the doctor selects a patient and clicks the “Start Seeing” button, the patient’s name and medical record number will appear in the “Current Patient” text box.</p><p><img src="/images/HIS/18.png" alt="1"></p><p>Visit Xu Qiang</p><p>(1) The doctor fills in the consultation information, here is all filled with “diarrhea”.<br>(2) The doctor clicks the “Submit” button to complete the submission.<br>(3) Xu Qiang will be transferred to the list of diagnosed patients.</p><p><img src="/images/HIS/19.png" alt="1"></p><p><img src="/images/HIS/20.png" alt="1"></p><h3 id="4-Prescribe-medication"><a href="#4-Prescribe-medication" class="headerlink" title="4. Prescribe medication"></a>4. Prescribe medication</h3><p>Prescribe Xu Qiang</p><p><img src="/images/HIS/21.png" alt="1"></p><p>Click “Show” in the prescription template, and the drug details under the current template will be displayed in the template details.</p><p><img src="/images/HIS/22.png" alt="1"></p><p>Click the “use” button to add the prescription to the outpatient prescription.</p><p><img src="/images/HIS/23.png" alt="1"></p><p><strong>New prescriptions:</strong><br>(1) Click the “Add Party Button”<br>(2) Fill in the name of the prescription<br>(3) Choose medicines (no more than 5 kinds)</p><p>Add 1 prescription, the name is: New Medicine No. 1</p><p><img src="/images/HIS/24.png" alt="1"></p><p>Choose medicine</p><p><img src="/images/HIS/25.png" alt="1"></p><p><img src="/images/HIS/26.png" alt="1"></p><p>Choose the following three medicines: yam granules, baizhi granules, huanglian granules.</p><p><img src="/images/HIS/27.png" alt="1"></p><p>result:</p><p><img src="/images/HIS/28.png" alt="1"></p><p><strong>Delete prescriptions:</strong><br>I deleted the new prescription No. 1 that I just created.</p><p><img src="/images/HIS/29.png" alt="1"></p><p>result:</p><p><img src="/images/HIS/30.png" alt="1"></p><p><strong>Select the prescription and proceed to issue</strong></p><p>Choose “Frequent Colds in Spring”</p><p><img src="/images/HIS/31.png" alt="1"></p><p>Click “Issue” in the outpatient prescription form, and the name of the template will be filled in the text box of “Confirmation of Issuing of Prescriptions” above.</p><p><img src="/images/HIS/32.png" alt="1"></p><p>Click the “Issue” button to complete the prescription issuance.</p><p><img src="/images/HIS/33.png" alt="1"></p><p>The four medicines in the prescription of “Frequent Influenza in Spring” are shown in the picture below:</p><p><img src="/images/HIS/34.png" alt="1"></p><h3 id="5-Charges"><a href="#5-Charges" class="headerlink" title="5. Charges"></a>5. Charges</h3><p>Enter Xu Qiang’s medical record number: 337336 on the charge page, and query Xu Qiang’s list of drugs paid on his behalf, and you can see that it is consistent with the drugs in 4 in the above figure.</p><p><img src="/images/HIS/35.png" alt="1"></p><p>You can pay all of the fees, or you can choose to pay a part of the fees. Here, you can choose two drugs, Danshen granules and phenolphthalein, to pay.</p><p><img src="/images/HIS/36.png" alt="1"></p><p>After selecting the drug, you need to click the “Confirm Drug and Amount Button”. After clicking, the name and total amount of the selected drug to be paid will be displayed</p><p><img src="/images/HIS/37.png" alt="1"></p><p>Click the “Settlement” button, and the invoice confirmation window will pop up. Click “Get Invoice Information” to display the current patient’s invoice information</p><p><img src="/images/HIS/38.png" alt="1"></p><p>Enter the actual amount received, and click “Show Change Amount” to display the change.</p><p><img src="/images/HIS/39.png" alt="1"></p><p>Re-check Xu Qiang’s paid drugs, you can see that there are only two drugs, because two drugs have just been paid</p><p><img src="/images/HIS/40.png" alt="1"></p><h3 id="6-Dispensing-medicine-in-pharmacy"><a href="#6-Dispensing-medicine-in-pharmacy" class="headerlink" title="6. Dispensing medicine in pharmacy"></a>6. Dispensing medicine in pharmacy</h3><p>Enter the drug delivery page of the pharmacy, click on the drug delivery of the pharmacy, enter Xu Qiang’s medical record number, search his list of paid drugs, which is the list of drugs to be issued, and you can see that they are the two drugs of Danshen granules and phenolphthalein that have just been paid. Select all medicines with one click, and click the “Dispensing” button. It displays “Successful drug delivery!”</p><p><img src="/images/HIS/41.png" alt="1"></p><p>Re-enter Xu Qiang’s medical record number and check again. No medicines were inquired this time, because the prescriptions had already been given to Xu Qiang, and Xu Qiang had no medicines to be dispatched (the medicines have been paid, but the medicines have not been distributed yet).</p><p><img src="/images/HIS/42.png" alt="1"></p><h3 id="7-Retire"><a href="#7-Retire" class="headerlink" title="7. Retire"></a>7. Retire</h3><p>Xia Ting went to return the account. Enter Xia Ting’s medical record number on the logout page to find out Xia Ting’s registration information. You can see that Xia Ting’s consultation status is not seen, so you can withdraw the number, select the registration record, and click the “return number” button to complete the return. No.</p><p><img src="/images/HIS/43.png" alt="1"></p><p>Consultation status: not seen</p><p><img src="/images/HIS/44.png" alt="1"></p><p>Retire successfully!</p><p><img src="/images/HIS/45.png" alt="1"></p><p>Enter Xia Ting’s medical record number again to query the registration information. At this time, Xia Ting’s medical status changed to “retired account.” Click the “return account” button again, and it will display “cannot return account twice!”</p><p>Consultation status: number has been withdrawn</p><p><img src="/images/HIS/46.png" alt="1"></p><p>Cannot return the account number twice!</p><p><img src="/images/HIS/47.png" alt="1"></p><p>Enter the medical record number of the patient Xu Qiang who has just seen the consultation, and you can see that the status of the consultation is: seen. This is if you click the “Return Number” button again, it will display “I have seen the consultation and cannot withdraw the number! “</p><p><img src="/images/HIS/48.png" alt="1"></p><p><img src="/images/HIS/49.png" alt="1"></p><h2 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h2><p><a href="https://github.com/xsb1999/HIS_Web">GitHub</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/HIS/50.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h2&gt;&lt;p&gt;The system developed in this practice project is the outpatient module in Neusoft Cloud Hospital Management System, which includes the following business functions.&lt;/p&gt;
&lt;p&gt;• Patient registration&lt;br&gt;• Patient withdrawal number&lt;br&gt;• Doctor visits&lt;br&gt;• The doctor distributes medicine&lt;br&gt;• Patient payment&lt;br&gt;• Dispensing medicine at the pharmacy&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;My work :&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;The front-end page part uses Bootstrap framework, part uses Axure to design and typeset the page; the back-end uses SpringBoot framework, uses Mybatis as the persistence layer framework, and uses Thymeleaf as the template engine to realize the front-end and back-end interaction; uses JavaScript, jQuery and Ajax to achieve related Perfect function.&lt;/p&gt;</summary>
    
    
    
    
    <category term="JavaScript" scheme="http://blog.andy.fit/tags/JavaScript/"/>
    
    <category term="HTML" scheme="http://blog.andy.fit/tags/HTML/"/>
    
    <category term="CSS" scheme="http://blog.andy.fit/tags/CSS/"/>
    
    <category term="Maven" scheme="http://blog.andy.fit/tags/Maven/"/>
    
    <category term="Java" scheme="http://blog.andy.fit/tags/Java/"/>
    
    <category term="Spring Boot" scheme="http://blog.andy.fit/tags/Spring-Boot/"/>
    
    <category term="MyBatis" scheme="http://blog.andy.fit/tags/MyBatis/"/>
    
    <category term="MySQL" scheme="http://blog.andy.fit/tags/MySQL/"/>
    
    <category term="Bootstrap" scheme="http://blog.andy.fit/tags/Bootstrap/"/>
    
  </entry>
  
</feed>
